---
import { getAllClusters } from '../lib/clusters';

const clusters = getAllClusters().slice(0, 6);
---

<header class="site-header">
  <div class="header-container">
    <!-- Logo -->
    <a href="/" class="logo">
      <img src="/logo-light-full.png" alt="VistaCEO" class="logo-img logo-light" />
      <img src="/logo-dark-full.png" alt="VistaCEO" class="logo-img logo-dark" style="display: none;" />
      <span class="logo-badge">Blog</span>
    </a>
    
    <!-- Desktop Navigation -->
    <nav class="main-nav">
      <ul class="nav-list">
        {clusters.map((cluster) => (
          <li>
            <a href={`/tema/${cluster.slug}`} class="nav-link">
              <span class="nav-emoji">{cluster.emoji}</span>
              <span class="nav-text">{cluster.name}</span>
            </a>
          </li>
        ))}
        <li>
          <a href="/tema/tendencias-ia-tech" class="nav-link" style="color: var(--primary);">
            Más temas →
          </a>
        </li>
      </ul>
    </nav>
    
    <!-- Actions -->
    <div class="header-actions">
      <button class="theme-toggle" id="theme-toggle" aria-label="Cambiar tema">
        <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
      
      <a href="https://www.vistaceo.com" class="header-cta" target="_blank" rel="noopener">
        <span>Probar VistaCEO</span>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M5 12h14M12 5l7 7-7 7"/>
        </svg>
      </a>
    </div>
    
    <!-- Mobile menu button -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Menu">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="3" y1="12" x2="21" y2="12"/>
        <line x1="3" y1="6" x2="21" y2="6"/>
        <line x1="3" y1="18" x2="21" y2="18"/>
      </svg>
    </button>
  </div>
</header>

<script>
  // Theme toggle
  const themeToggle = document.getElementById('theme-toggle');
  const sunIcon = themeToggle?.querySelector('.sun-icon');
  const moonIcon = themeToggle?.querySelector('.moon-icon');
  const logoLight = document.querySelector('.logo-light') as HTMLElement;
  const logoDark = document.querySelector('.logo-dark') as HTMLElement;
  
  function updateTheme(isDark: boolean) {
    document.documentElement.classList.toggle('dark', isDark);
    if (sunIcon && moonIcon) {
      (sunIcon as HTMLElement).style.display = isDark ? 'none' : 'block';
      (moonIcon as HTMLElement).style.display = isDark ? 'block' : 'none';
    }
    if (logoLight && logoDark) {
      logoLight.style.display = isDark ? 'none' : 'block';
      logoDark.style.display = isDark ? 'block' : 'none';
    }
    localStorage.setItem('theme', isDark ? 'dark' : 'light');
  }
  
  // Check for saved theme or system preference
  const savedTheme = localStorage.getItem('theme');
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
  const isDark = savedTheme ? savedTheme === 'dark' : prefersDark;
  updateTheme(isDark);
  
  themeToggle?.addEventListener('click', () => {
    const isDark = document.documentElement.classList.contains('dark');
    updateTheme(!isDark);
  });
</script>
